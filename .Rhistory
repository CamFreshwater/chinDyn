#J14, K12, L07, L11 had calves in 1987
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1986" & SRKW_FecuTrimmed$ID %in% c("J14", "K12", "L07", "L11")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1988" & SRKW_FecuTrimmed$ID %in% c("J14", "K12", "L07", "L11")),]
#J11, K14 had calves in 1988
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1987" & SRKW_FecuTrimmed$ID %in% c("J11", "K14")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1989" & SRKW_FecuTrimmed$ID %in% c("J11", "K14")),]
#L02, L22 had calves in 1989
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1988" & SRKW_FecuTrimmed$ID %in% c("L02", "L22")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1990" & SRKW_FecuTrimmed$ID %in% c("L02", "L22")),]
#K14, L27, L47, L51, L55, L60 had calves in 1990
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1989" & SRKW_FecuTrimmed$ID %in% c("K14", "L27", "L47", "L51", "L55", "L60")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1991" & SRKW_FecuTrimmed$ID %in% c("K14", "L27", "L47", "L51", "L55", "L60")),]
#J11, J16, K13, L04, L28 had calves in 1991
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1990" & SRKW_FecuTrimmed$ID %in% c("J11", "J16", "K13", "L04", "L28")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1992" & SRKW_FecuTrimmed$ID %in% c("J11", "J16", "K13", "L04", "L28")),]
#L32 had calves in 1992
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1991" & SRKW_FecuTrimmed$ID %in% c("L32")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1993" & SRKW_FecuTrimmed$ID %in% c("L32")),]
#J0A, J17, J19, K14, L02, L22, L26 had calves in 1993
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1992" & SRKW_FecuTrimmed$ID %in% c("J0A", "J17", "J19", "K14", "L02", "L22", "L26")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1994" & SRKW_FecuTrimmed$ID %in% c("J0A", "J17", "J19", "K14", "L02", "L22", "L26")),]
#K12, K13 had calves in 1994
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1993" & SRKW_FecuTrimmed$ID %in% c("K12", "K13")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1995" & SRKW_FecuTrimmed$ID %in% c("K12", "K13")),]
#J11, J14, L11, L27, L47, L60 had calves in 1995
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1994" & SRKW_FecuTrimmed$ID %in% c("J11", "J14", "L11", "L27", "L47", "L60")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1996" & SRKW_FecuTrimmed$ID %in% c("J11", "J14", "L11", "L27", "L47", "L60")),]
#J16, J20, K03, L43, L55 had calves in 1996
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1995" & SRKW_FecuTrimmed$ID %in% c("J16", "J20", "K03", "L43", "L55")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1997" & SRKW_FecuTrimmed$ID %in% c("J16", "J20", "K03", "L43", "L55")),]
# No calves in 1997
#J17, J22 had calves in 1998
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1997" & SRKW_FecuTrimmed$ID %in% c("J17", "J22")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1999" & SRKW_FecuTrimmed$ID %in% c("J17", "J22")),]
#J16, K12, L51, L67 had calves in 1999
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1998" & SRKW_FecuTrimmed$ID %in% c("J16", "K12", "L51", "L67")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2000" & SRKW_FecuTrimmed$ID %in% c("J16", "K12", "L51", "L67")),]
#K16, L47 had calves in 2000
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1999" & SRKW_FecuTrimmed$ID %in% c("K16", "L47")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2001" & SRKW_FecuTrimmed$ID %in% c("K16", "L47")),]
#J14, K13, K22, L54 had calves in 2001
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2000" & SRKW_FecuTrimmed$ID %in% c("J14", "K13", "K22", "L54")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2002" & SRKW_FecuTrimmed$ID %in% c("J14", "K13", "K22", "L54")),]
#K16, L47, L67 had calves in 2002
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2001" & SRKW_FecuTrimmed$ID %in% c("K16", "L47", "L67")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2003" & SRKW_FecuTrimmed$ID %in% c("K16", "L47", "L67")),]
#J11, J22, K12, K14, L55 had calves in 2003
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2002" & SRKW_FecuTrimmed$ID %in% c("J11", "J22", "K12", "K14", "L55")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2004" & SRKW_FecuTrimmed$ID %in% c("J11", "J22", "K12", "K14", "L55")),]
#J14, K20, L43, L72 had calves in 2004
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2003" & SRKW_FecuTrimmed$ID %in% c("J14", "K20", "L43", "L72")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2005" & SRKW_FecuTrimmed$ID %in% c("J14", "K20", "L43", "L72")),]
#J19, L47, L86 had calves in 2005
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2004" & SRKW_FecuTrimmed$ID %in% c("J19", "L47", "L86")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2006" & SRKW_FecuTrimmed$ID %in% c("J19", "L47", "L86")),]
#K22, K28, L54 had calves in 2006
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2005" & SRKW_FecuTrimmed$ID %in% c("K22", "K28", "L54")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2007" & SRKW_FecuTrimmed$ID %in% c("K22", "K28", "L54")),]
#J14, J16, L55, L83 had calves in 2007
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2006" & SRKW_FecuTrimmed$ID %in% c("J14", "J16", "L55", "L83")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2008" & SRKW_FecuTrimmed$ID %in% c("J14", "J16", "L55", "L83")),]
#K14, L47 had calves in 2008
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2007" & SRKW_FecuTrimmed$ID %in% c("K14", "L47")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2009" & SRKW_FecuTrimmed$ID %in% c("K14", "L47")),]
#J14, J17, J28, L86, L94 had calves in 2009
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2008" & SRKW_FecuTrimmed$ID %in% c("J14", "J17", "J28", "L86", "L94")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2010" & SRKW_FecuTrimmed$ID %in% c("J14", "J17", "J28", "L86", "L94")),]
#J35, K12, L47, L54, L77, L82 had calves in 2010
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2009" & SRKW_FecuTrimmed$ID %in% c("J35", "K12", "L47", "L54", "L77", "L82")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2011" & SRKW_FecuTrimmed$ID %in% c("J35", "K12", "L47", "L54", "L77", "L82")),]
#J16, K27, L55 had calves in 2011
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2010" & SRKW_FecuTrimmed$ID %in% c("J16", "K27", "L55")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2012" & SRKW_FecuTrimmed$ID %in% c("J16", "K27", "L55")),]
#J37, L77 had calves in 2012
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2011" & SRKW_FecuTrimmed$ID %in% c("J37", "L77")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2013" & SRKW_FecuTrimmed$ID %in% c("J37", "L77")),]
# No calves in 2013
#J16, L86 had calves in 2014
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2013" & SRKW_FecuTrimmed$ID %in% c("J16", "L86")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2015" & SRKW_FecuTrimmed$ID %in% c("J16", "L86")),]
#J17, J28, J36, J41, L103, L91, L94 had calves in 2015
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2014" & SRKW_FecuTrimmed$ID %in% c("J17", "J28", "J36", "J41", "L103", "L91", "L94")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2016" & SRKW_FecuTrimmed$ID %in% c("J17", "J28", "J36", "J41", "L103", "L91", "L94")),]
#J40 had calves in 2016
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2015" & SRKW_FecuTrimmed$ID %in% c("J40")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2017" & SRKW_FecuTrimmed$ID %in% c("J40")),]
# No calves in 2017
#SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2016" & SRKW_FecuTrimmed$ID %in% c("")),]
### Removal of females with assigned ages, to follow Ward et al. 2009 ----
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="J05"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="J12"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="K03"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L02"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L03"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L11"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L21"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L23"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L45"),] #No births after 1980
#For since-1980 data
NRKW_Live_Females <- read.csv(here("data", "NRKW_Live_Females_since_1980.csv"),
stringsAsFactors = FALSE,
strip.white = TRUE,
na.strings =c("NA"))
### Create "NRKW_fecundity" dataframe by adding birth, calf data, age, and
## salmon to live females and trimming out females on years adjacent births and
## those removed from Ward et al. ----
##Add year of birth to live females
#dfsNRKW1<- list(NRKW_Live_Females, NRKW_Females_YOB)
#join_all(dfsNRKW1, type="left", match = "all")
NRKW_fecundity3 <- merge(NRKW_Live_Females, NRKW_Females_YOB, by=c("ID"))
head(NRKW_fecundity3)
##Add calf data to fecundity3
#change column names of calf data from "mother" to "ID" to allow merging.  We're interested in whether the mother Calved, rather than who mothered each whale
head(NRKW_Calved)
colnames(NRKW_Calved) <- c("ID", "Year", "Calved")
dfsNRKW1980 <- list(NRKW_fecundity3, NRKW_Calved)
NRKW_fecundity2 <- join_all(dfsNRKW1980, type="left", match = "all")
head(NRKW_fecundity2)
NRKW_fecundity2$Calved[is.na(NRKW_fecundity2$Calved)]<-0 #Changing NAs to 0s to allow for binomial analysis
#adding age
head(NRKW_fecundity2)
NRKW_fecundity2$Age <- (NRKW_fecundity2$Year-NRKW_fecundity2$YoB)
NRKW_fecundity2 <- NRKW_fecundity2[!(NRKW_fecundity2$Age<8),] #removing those less than 8 years old
head(NRKW_fecundity2)
### Remove NRKW whales that gave birth in an adjacent year----
#ie. if calved in 2009, not counted in 2008 or 2010
#copy dataframe into new one for trimming
NRKW_FecuTrimmed<-NRKW_fecundity2
###A14, B07, C06, G03, I11, I20, R05, R07, I17*  had calves in 1979    *I17 was "1979.5" but included here
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1980" & NRKW_FecuTrimmed$ID %in% c("A14", "B07", "C06", "G03", "I11", "I20", "R05", "R07", "I17")),]
### A08, G17, I01, I15, I18, I22, I31 had calves in 1980
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1981" & NRKW_FecuTrimmed$ID %in% c("A08", "G17", "I01", "I15", "I18", "I22", "I31")),]
### A23, A24, A30, G02, G18, H03 had calves in 1981
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1980" & NRKW_FecuTrimmed$ID %in% c("A23", "A24", "A30", "G02", "G18", "H03")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1982" & NRKW_FecuTrimmed$ID %in% c("A23", "A24", "A30", "G02", "G18", "H03")),]
### A36, D08, G03, R18, I17* had calves in 1982    *I17 was "1982.5" but included here
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1981" & NRKW_FecuTrimmed$ID %in% c("A36", "D08", "G03", "R18", "I17")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1983" & NRKW_FecuTrimmed$ID %in% c("A36", "D08", "G03", "R18", "I17")),]
### A10, A11, A24, I07, I11, I16, I19 had calves in 1983
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1982" & NRKW_FecuTrimmed$ID %in% c("A10", "A11", "A24", "I07", "I11", "I16", "I19")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1984" & NRKW_FecuTrimmed$ID %in% c("A10", "A11", "A24", "I07", "I11", "I16", "I19")),]
### A30, B07, D07, G20, R04 had calves in 1984
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1983" & NRKW_FecuTrimmed$ID %in% c("A30", "B07", "D07", "G20", "R04")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1985" & NRKW_FecuTrimmed$ID %in% c("A30", "B07", "D07", "G20", "R04")),]
### A24, C06, C10, G02, G08, I12, I15, I31, I33, R17 had calves in 1985
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1984" & NRKW_FecuTrimmed$ID %in% c("A24", "C06", "C10", "G02", "G08", "I12", "I15", "I31", "I33", "R17")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1986" & NRKW_FecuTrimmed$ID %in% c("A24", "C06", "C10", "G02", "G08", "I12", "I15", "I31", "I33", "R17")),]
### A25, G12, G16, G17, H03, I16, I18, I19, I20 had calves in 1986
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1985" & NRKW_FecuTrimmed$ID %in% c("A25", "G12", "G16", "G17", "H03", "I16", "I18", "I19", "I20")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1987" & NRKW_FecuTrimmed$ID %in% c("A25", "G12", "G16", "G17", "H03", "I16", "I18", "I19", "I20")),]
### A35, B07, D08, D09, D11, G25, G27, I22, I26, R05, R18 had calves in 1987
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1986" & NRKW_FecuTrimmed$ID %in% c("A35", "B07", "D08", "D09", "D11", "G25", "G27", "I22", "I26", "R05", "R18")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1988" & NRKW_FecuTrimmed$ID %in% c("A35", "B07", "D08", "D09", "D11", "G25", "G27", "I22", "I26", "R05", "R18")),]
### A24, G29, H05, I07, I33, I35, R04 had calves in 1988
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1987" & NRKW_FecuTrimmed$ID %in% c("A24", "G29", "H05", "I07", "I33", "I35", "R04")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1989" & NRKW_FecuTrimmed$ID %in% c("A24", "G29", "H05", "I07", "I33", "I35", "R04")),]
### A30, C08, C10, G02, G03, I17, I18 had calves in 1989
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1988" & NRKW_FecuTrimmed$ID %in% c("A30", "C08", "C10", "G02", "G03", "I17", "I18")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1990" & NRKW_FecuTrimmed$ID %in% c("A30", "C08", "C10", "G02", "G03", "I17", "I18")),]
### A11, A34, D11, G08, G20, G34, I11, I15, I27, R17 had calves in 1990
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1989" & NRKW_FecuTrimmed$ID %in% c("A11", "A34", "D11", "G08", "G20", "G34", "I11", "I15", "I27", "R17")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1991" & NRKW_FecuTrimmed$ID %in% c("A11", "A34", "D11", "G08", "G20", "G34", "I11", "I15", "I27", "R17")),]
### A42, B07, C06, C08, G23, G29, I20, I31, I35, I40 had calves in 1991
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1990" & NRKW_FecuTrimmed$ID %in% c("A42", "B07", "C06", "C08", "G23", "G29", "I20", "I31", "I35", "I40")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1992" & NRKW_FecuTrimmed$ID %in% c("A42", "B07", "C06", "C08", "G23", "G29", "I20", "I31", "I35", "I40")),]
### A23, A24, A35, G22, G25, I18, I26, R04, G16* had calves in 1992    *G16 was "1992.5" but included here
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1991" & NRKW_FecuTrimmed$ID %in% c("A23", "A24", "A35", "G22", "G25", "I18", "I26", "R04", "G16")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1993" & NRKW_FecuTrimmed$ID %in% c("A23", "A24", "A35", "G22", "G25", "I18", "I26", "R04", "G16")),]
### C10, I16, I19, I54 had calves in 1993
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1992" & NRKW_FecuTrimmed$ID %in% c("C10", "I16", "I19", "I54")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1994" & NRKW_FecuTrimmed$ID %in% c("C10", "I16", "I19", "I54")),]
### A25, A34, C08, G02, G20, G31, G34, H03, I35, I40, R05, R22 had calves in 1994
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1993" & NRKW_FecuTrimmed$ID %in% c("A25", "A34", "C08", "G02", "G20", "G31", "G34", "H03", "I35", "I40", "R05", "R22")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1995" & NRKW_FecuTrimmed$ID %in% c("A25", "A34", "C08", "G02", "G20", "G31", "G34", "H03", "I35", "I40", "R05", "R22")),]
### A24, A43, B07, D08, G23, I13, R04 had calves in 1995
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1994" & NRKW_FecuTrimmed$ID %in% c("A24", "A43", "B07", "D08", "G23", "I13", "R04")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1996" & NRKW_FecuTrimmed$ID %in% c("A24", "A43", "B07", "D08", "G23", "I13", "R04")),]
### A42, A48, G27, I17, I21, I26, I50, R17 had calves in 1996
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1995" & NRKW_FecuTrimmed$ID %in% c("A42", "A48", "G27", "I17", "I21", "I26", "I50", "R17")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1997" & NRKW_FecuTrimmed$ID %in% c("A42", "A48", "G27", "I17", "I21", "I26", "I50", "R17")),]
### A34, A43, A45, C08, I04, I12, I20, I27, I33, I36, I54, R20, R24 had calves in 1997
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1996" & NRKW_FecuTrimmed$ID %in% c("A34", "A43", "A45", "C08", "I04", "I12", "I20", "I27", "I33", "I36", "I54", "R20", "R24")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1998" & NRKW_FecuTrimmed$ID %in% c("A34", "A43", "A45", "C08", "I04", "I12", "I20", "I27", "I33", "I36", "I54", "R20", "R24")),]
### C10, D13, G20, G25, I16, I35, R04, R22 had calves in 1998
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1997" & NRKW_FecuTrimmed$ID %in% c("C10", "D13", "G20", "G25", "I16", "I35", "R04", "R22")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1999" & NRKW_FecuTrimmed$ID %in% c("C10", "D13", "G20", "G25", "I16", "I35", "R04", "R22")),]
### A24, A35, A50, D12, G08, G31, G37, I19, I40, R18, R23* had calves in 1999    *R23 was "1999.5" but included here
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1998" & NRKW_FecuTrimmed$ID %in% c("A24, A35, A50, D12, G08, G31, G37, I19, I40, R18, R23")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2000" & NRKW_FecuTrimmed$ID %in% c("A24, A35, A50, D12, G08, G31, G37, I19, I40, R18, R23")),]
### A45, C13, G27, H05, I17 had calves in 2000
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="1999" & NRKW_FecuTrimmed$ID %in% c("A45", "C13", "G27", "H05", "I17")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2001" & NRKW_FecuTrimmed$ID %in% c("A45", "C13", "G27", "H05", "I17")),]
### A34, G20, G22, G23, I21, I33, R22, R24 had calves in 2001
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2000" & NRKW_FecuTrimmed$ID %in% c("A34", "G20", "G22", "G23", "I21", "I33", "R22", "R24")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2002" & NRKW_FecuTrimmed$ID %in% c("A34", "G20", "G22", "G23", "I21", "I33", "R22", "R24")),]
### A52, A54, H09, I16, I24, I35, I54, R04, R17, R23 had calves in 2002
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2001" & NRKW_FecuTrimmed$ID %in% c("A52", "A54", "H09", "I16", "I24", "I35", "I54", "R04", "R17", "R23")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2003" & NRKW_FecuTrimmed$ID %in% c("A52", "A54", "H09", "I16", "I24", "I35", "I54", "R04", "R17", "R23")),]
### A24, A35, G34, I04, I17, I20, I50, I65, C08* had calves in 2003    *C08 was "2003.5" but included here
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2002" & NRKW_FecuTrimmed$ID %in% c("A24", "A35", "G34", "I04", "I17", "I20", "I50", "I65", "C08")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2004" & NRKW_FecuTrimmed$ID %in% c("A24", "A35", "G34", "I04", "I17", "I20", "I50", "I65", "C08")),]
### A34, A42, A52, A59, B14, C10, D11, D17, G20, G25, H05, I12, I27, I51, R18, R22, R24, G46* had calves in 2004    *G46 was "2004.5" but included here
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2003" & NRKW_FecuTrimmed$ID %in% c("A34", "A42", "A52", "A59", "B14", "C10", "D11", "D17", "G20", "G25", "H05", "I12", "I27", "I51", "R18", "R22", "R24", "G46")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2005" & NRKW_FecuTrimmed$ID %in% c("A34", "A42", "A52", "A59", "B14", "C10", "D11", "D17", "G20", "G25", "H05", "I12", "I27", "I51", "R18", "R22", "R24", "G46")),]
### A50, A62, D13, G02, G22, G23, G27, G41, G49, H08, I13, I19, I40, R13 had calves in 2005
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2004" & NRKW_FecuTrimmed$ID %in% c("A50", "A62", "D13", "G02", "G22", "G23", "G27", "G41", "G49", "H08", "I13", "I19", "I40", "R13")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2006" & NRKW_FecuTrimmed$ID %in% c("A50", "A62", "D13", "G02", "G22", "G23", "G27", "G41", "G49", "H08", "I13", "I19", "I40", "R13")),]
### A51, A54, C21, G37, G51, I16, I21, I26, I33, I54, I68, I69, I71, I82, R23, R29 had calves in 2006
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2005" & NRKW_FecuTrimmed$ID %in% c("A51", "A54", "C21", "G37", "G51", "I16", "I21", "I26", "I33", "I54", "I68", "I69", "I71", "I82", "R23", "R29")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2007" & NRKW_FecuTrimmed$ID %in% c("A51", "A54", "C21", "G37", "G51", "I16", "I21", "I26", "I33", "I54", "I68", "I69", "I71", "I82", "R23", "R29")),]
### 13: A56, C13, D10, D11, G31, G48, G53, I22, I24, I35, I57, I65, R22 had calves in 2007
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2006" & NRKW_FecuTrimmed$ID %in% c("A56", "C13", "D10", "D11", "G31", "G48", "G53", "I22", "I24", "I35", "I57", "I65", "R22")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2008" & NRKW_FecuTrimmed$ID %in% c("A56", "C13", "D10", "D11", "G31", "G48", "G53", "I22", "I24", "I35", "I57", "I65", "R22")),]
### 17*: A35, A42, A64, B14, G22, G25, G29, G34, G41, G52, G54, H09, I17, I83, I92, R24 in 2008 *B14 calved twice according to the data... so only 16 producing females in this list
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2007" & NRKW_FecuTrimmed$ID %in% c("A35","A42", "A64", "B14", "G22", "G25", "G29", "G34", "G41", "G52", "G54", "H09", "I17", "I83", "I92", "R24")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2009" & NRKW_FecuTrimmed$ID %in% c("A35","A42", "A64", "B14", "G22", "G25", "G29", "G34", "G41", "G52", "G54", "H09", "I17", "I83", "I92", "R24")),]
### 13: A24	A54	A62	A67	A69	C10	C19	C23	G20	I16	I51	R23	R38 in 2009
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2008" & NRKW_FecuTrimmed$ID %in% c("A24", "A54", "A62", "A67", "A69", "C10", "C19", "C23", "G20", "I16", "I51", "R23", "R38")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2010" & NRKW_FecuTrimmed$ID %in% c("A24", "A54", "A62", "A67", "A69", "C10", "C19", "C23", "G20", "I16", "I51", "R23", "R38")),]
### 13: A34	A51	A56	D17	G52	G63	I19	I21	I40	I50	I71	R29	R35 in 2010
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2009" & NRKW_FecuTrimmed$ID %in% c("A34", "A51", "A56", "D17", "G52", "G63", "I19", "I21", "I40", "I50", "I71", "R29", "R35")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2011" & NRKW_FecuTrimmed$ID %in% c("A34", "A51", "A56", "D17", "G52", "G63", "I19", "I21", "I40", "I50", "I71", "R29", "R35")),]
### 10: A50	A70	G31	G49	G50	G58	I13	R13	R22	R24 in 2011
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2010" & NRKW_FecuTrimmed$ID %in% c("A50", "A70", "G31", "G49", "G50", "G58", "I13", "R13", "R22", "R24")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2012" & NRKW_FecuTrimmed$ID %in% c("A50", "A70", "G31", "G49", "G50", "G58", "I13", "R13", "R22", "R24")),]
### 14: A67	A75	D13	G22	G27	G37	G53	G54	G64	H09	I12	I35	I68	I90 in 2012
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2011" & NRKW_FecuTrimmed$ID %in% c("A67", "A75", "D13", "G22", "G27", "G37", "G53", "G54", "G64", "H09", "I12", "I35", "I68", "I90")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2013" & NRKW_FecuTrimmed$ID %in% c("A67", "A75", "D13", "G22", "G27", "G37", "G53", "G54", "G64", "H09", "I12", "I35", "I68", "I90")),]
### 15: A42	A52	A54	A62	A73	C13	D11	G48	G50	H12	I54	I69	I83	R38	R39 in 2013
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2012" & NRKW_FecuTrimmed$ID %in% c("A42", "A52", "A54", "A62", "A73", "C13", "D11", "G48", "G50", "H12", "I54", "I69", "I83", "R38", "R39")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2014" & NRKW_FecuTrimmed$ID %in% c("A42", "A52", "A54", "A62", "A73", "C13", "D11", "G48", "G50", "H12", "I54", "I69", "I83", "R38", "R39")),]
### 18: A69	A72	B14	C08	C26	D20	G51	G69	I104	I21	I26	I50	I51	I63	I65	I99	R40	R41 in 2014
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2013" & NRKW_FecuTrimmed$ID %in% c("A69", "A72", "B14", "C08", "C26", "D20", "G51", "G69", "I104", "I21", "I26", "I50", "I51", "I63", "I65", "I99", "R40", "R41")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2015" & NRKW_FecuTrimmed$ID %in% c("A69", "A72", "B14", "C08", "C26", "D20", "G51", "G69", "I104", "I21", "I26", "I50", "I51", "I63", "I65", "I99", "R40", "R41")),]
### 12: A64	C23	D17	D19	G50	G63	I100	I96	R22	R24	R29	R35 in 2015
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2014" & NRKW_FecuTrimmed$ID %in% c("A64", "C23", "D17", "D19", "G50", "G63", "I100", "I96", "R22", "R24", "R29", "R35")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2016" & NRKW_FecuTrimmed$ID %in% c("A64", "C23", "D17", "D19", "G50", "G63", "I100", "I96", "R22", "R24", "R29", "R35")),]
###  7: A67	A70	A75	G41	I16	I27	R23 in 2016
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2015" & NRKW_FecuTrimmed$ID %in% c("A67", "A70", "A75", "G41", "I16", "I27", "R23")),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2017" & NRKW_FecuTrimmed$ID %in% c("A67", "A70", "A75", "G41", "I16", "I27", "R23")),]
### 10: A35	A42	A50	A73	G22	G58 G77	G62	I40	I92 in 2017
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$Year=="2016" & NRKW_FecuTrimmed$ID %in% c("A35", "A42", "A50", "A73", "G22", "G58 G77", "G62", "I40", "I92")),]
### Removal of NRKW females with assigned ages, to follow Ward et al. 2009 ----
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$ID=="A35"),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$ID=="B17"),] #did not give birth in our data
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$ID=="I17"),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$ID=="I18"),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$ID=="I31"),]
NRKW_FecuTrimmed<-NRKW_FecuTrimmed[!(NRKW_FecuTrimmed$ID=="R5"),]
### Create "SRKW_fecundity" dataframe by adding birth, calf data, age, and salmon to live females and trimming out females on years adjacent births and those removed from Ward et al. ----
##Add year of birth to live females
head(SRKW_Females_YOB)
colnames(SRKW_Females_YOB) <- c("ID", "YoB")
SRKW_fecundity3 <- merge(SRKW_Live_Females, SRKW_Females_YOB, by=c("ID"))
head(SRKW_fecundity3)
##Add calf data to fecundity3
#change column names of calf data from "MOTHER" to "ID" to allow merging.  We're interested in whether the mother Calved, rather than who mothered each whale
head(SRKW_Calved)
colnames(SRKW_Calved) <- c("Year", "ID", "Calved")
dfsSRKW <- list(SRKW_fecundity3, SRKW_Calved)
SRKW_fecundity2 <- join_all(dfsSRKW, type="left", match = "all")
head(SRKW_fecundity2)
SRKW_fecundity2$Calved[is.na(SRKW_fecundity2$Calved)]<-0 #Changing NAs to 0s to allow for binomial analysis
#adding age
SRKW_fecundity2$Age <- (SRKW_fecundity2$Year-SRKW_fecundity2$YoB)
SRKW_fecundity2 <- SRKW_fecundity2[!(SRKW_fecundity2$Age<8),] #removing those less than 8 years old
head(SRKW_fecundity2)
### Remove SRKW whales that gave birth in an adjacent year----
#ie. if Calved in 2009, not counted in 2008 or 2010
#copy dataframe into new one for trimming
SRKW_FecuTrimmed<-SRKW_fecundity2
#J04, L03, L23 had calves in 1979
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1980" & SRKW_FecuTrimmed$ID %in% c("J04", "L03", "L23")),]
#L05, L26, L27 had calves in 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1981" & SRKW_FecuTrimmed$ID %in% c("L05", "L26", "L27")),]
#L10 had a calf in 1981
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1980" & SRKW_FecuTrimmed$ID %in% c("L10")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1982" & SRKW_FecuTrimmed$ID %in% c("L10")),]
#J04 had a calf in 1982
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1981" & SRKW_FecuTrimmed$ID %in% c("J04")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1983" & SRKW_FecuTrimmed$ID %in% c("J04")),]
#no calves in 1983
#L28, L32, L35 had calves in 1984
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1983" & SRKW_FecuTrimmed$ID %in% c("L28", "L32", "L35")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1985" & SRKW_FecuTrimmed$ID %in% c("L28", "L32", "L35")),]
#J10, K03, L02, L11, L27 had calves in 1985
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1984" & SRKW_FecuTrimmed$ID %in% c("J10", "K03", "L02", "L11", "L27")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1986" & SRKW_FecuTrimmed$ID %in% c("J10", "K03", "L02", "L11", "L27")),]
#K13, K18, L03, L05, L22, L26, L43 had calves in 1986
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1985" & SRKW_FecuTrimmed$ID %in% c("K13", "K18", "L03", "L05", "L22", "L26", "L43")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1987" & SRKW_FecuTrimmed$ID %in% c("K13", "K18", "L03", "L05", "L22", "L26", "L43")),]
#J14, K12, L07, L11 had calves in 1987
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1986" & SRKW_FecuTrimmed$ID %in% c("J14", "K12", "L07", "L11")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1988" & SRKW_FecuTrimmed$ID %in% c("J14", "K12", "L07", "L11")),]
#J11, K14 had calves in 1988
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1987" & SRKW_FecuTrimmed$ID %in% c("J11", "K14")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1989" & SRKW_FecuTrimmed$ID %in% c("J11", "K14")),]
#L02, L22 had calves in 1989
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1988" & SRKW_FecuTrimmed$ID %in% c("L02", "L22")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1990" & SRKW_FecuTrimmed$ID %in% c("L02", "L22")),]
#K14, L27, L47, L51, L55, L60 had calves in 1990
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1989" & SRKW_FecuTrimmed$ID %in% c("K14", "L27", "L47", "L51", "L55", "L60")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1991" & SRKW_FecuTrimmed$ID %in% c("K14", "L27", "L47", "L51", "L55", "L60")),]
#J11, J16, K13, L04, L28 had calves in 1991
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1990" & SRKW_FecuTrimmed$ID %in% c("J11", "J16", "K13", "L04", "L28")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1992" & SRKW_FecuTrimmed$ID %in% c("J11", "J16", "K13", "L04", "L28")),]
#L32 had calves in 1992
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1991" & SRKW_FecuTrimmed$ID %in% c("L32")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1993" & SRKW_FecuTrimmed$ID %in% c("L32")),]
#J0A, J17, J19, K14, L02, L22, L26 had calves in 1993
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1992" & SRKW_FecuTrimmed$ID %in% c("J0A", "J17", "J19", "K14", "L02", "L22", "L26")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1994" & SRKW_FecuTrimmed$ID %in% c("J0A", "J17", "J19", "K14", "L02", "L22", "L26")),]
#K12, K13 had calves in 1994
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1993" & SRKW_FecuTrimmed$ID %in% c("K12", "K13")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1995" & SRKW_FecuTrimmed$ID %in% c("K12", "K13")),]
#J11, J14, L11, L27, L47, L60 had calves in 1995
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1994" & SRKW_FecuTrimmed$ID %in% c("J11", "J14", "L11", "L27", "L47", "L60")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1996" & SRKW_FecuTrimmed$ID %in% c("J11", "J14", "L11", "L27", "L47", "L60")),]
#J16, J20, K03, L43, L55 had calves in 1996
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1995" & SRKW_FecuTrimmed$ID %in% c("J16", "J20", "K03", "L43", "L55")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1997" & SRKW_FecuTrimmed$ID %in% c("J16", "J20", "K03", "L43", "L55")),]
# No calves in 1997
#J17, J22 had calves in 1998
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1997" & SRKW_FecuTrimmed$ID %in% c("J17", "J22")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1999" & SRKW_FecuTrimmed$ID %in% c("J17", "J22")),]
#J16, K12, L51, L67 had calves in 1999
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1998" & SRKW_FecuTrimmed$ID %in% c("J16", "K12", "L51", "L67")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2000" & SRKW_FecuTrimmed$ID %in% c("J16", "K12", "L51", "L67")),]
#K16, L47 had calves in 2000
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="1999" & SRKW_FecuTrimmed$ID %in% c("K16", "L47")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2001" & SRKW_FecuTrimmed$ID %in% c("K16", "L47")),]
#J14, K13, K22, L54 had calves in 2001
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2000" & SRKW_FecuTrimmed$ID %in% c("J14", "K13", "K22", "L54")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2002" & SRKW_FecuTrimmed$ID %in% c("J14", "K13", "K22", "L54")),]
#K16, L47, L67 had calves in 2002
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2001" & SRKW_FecuTrimmed$ID %in% c("K16", "L47", "L67")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2003" & SRKW_FecuTrimmed$ID %in% c("K16", "L47", "L67")),]
#J11, J22, K12, K14, L55 had calves in 2003
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2002" & SRKW_FecuTrimmed$ID %in% c("J11", "J22", "K12", "K14", "L55")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2004" & SRKW_FecuTrimmed$ID %in% c("J11", "J22", "K12", "K14", "L55")),]
#J14, K20, L43, L72 had calves in 2004
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2003" & SRKW_FecuTrimmed$ID %in% c("J14", "K20", "L43", "L72")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2005" & SRKW_FecuTrimmed$ID %in% c("J14", "K20", "L43", "L72")),]
#J19, L47, L86 had calves in 2005
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2004" & SRKW_FecuTrimmed$ID %in% c("J19", "L47", "L86")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2006" & SRKW_FecuTrimmed$ID %in% c("J19", "L47", "L86")),]
#K22, K28, L54 had calves in 2006
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2005" & SRKW_FecuTrimmed$ID %in% c("K22", "K28", "L54")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2007" & SRKW_FecuTrimmed$ID %in% c("K22", "K28", "L54")),]
#J14, J16, L55, L83 had calves in 2007
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2006" & SRKW_FecuTrimmed$ID %in% c("J14", "J16", "L55", "L83")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2008" & SRKW_FecuTrimmed$ID %in% c("J14", "J16", "L55", "L83")),]
#K14, L47 had calves in 2008
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2007" & SRKW_FecuTrimmed$ID %in% c("K14", "L47")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2009" & SRKW_FecuTrimmed$ID %in% c("K14", "L47")),]
#J14, J17, J28, L86, L94 had calves in 2009
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2008" & SRKW_FecuTrimmed$ID %in% c("J14", "J17", "J28", "L86", "L94")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2010" & SRKW_FecuTrimmed$ID %in% c("J14", "J17", "J28", "L86", "L94")),]
#J35, K12, L47, L54, L77, L82 had calves in 2010
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2009" & SRKW_FecuTrimmed$ID %in% c("J35", "K12", "L47", "L54", "L77", "L82")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2011" & SRKW_FecuTrimmed$ID %in% c("J35", "K12", "L47", "L54", "L77", "L82")),]
#J16, K27, L55 had calves in 2011
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2010" & SRKW_FecuTrimmed$ID %in% c("J16", "K27", "L55")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2012" & SRKW_FecuTrimmed$ID %in% c("J16", "K27", "L55")),]
#J37, L77 had calves in 2012
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2011" & SRKW_FecuTrimmed$ID %in% c("J37", "L77")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2013" & SRKW_FecuTrimmed$ID %in% c("J37", "L77")),]
# No calves in 2013
#J16, L86 had calves in 2014
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2013" & SRKW_FecuTrimmed$ID %in% c("J16", "L86")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2015" & SRKW_FecuTrimmed$ID %in% c("J16", "L86")),]
#J17, J28, J36, J41, L103, L91, L94 had calves in 2015
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2014" & SRKW_FecuTrimmed$ID %in% c("J17", "J28", "J36", "J41", "L103", "L91", "L94")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2016" & SRKW_FecuTrimmed$ID %in% c("J17", "J28", "J36", "J41", "L103", "L91", "L94")),]
#J40 had calves in 2016
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2015" & SRKW_FecuTrimmed$ID %in% c("J40")),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2017" & SRKW_FecuTrimmed$ID %in% c("J40")),]
# No calves in 2017
#SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$Year=="2016" & SRKW_FecuTrimmed$ID %in% c("")),]
### Removal of females with assigned ages, to follow Ward et al. 2009 ----
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="J05"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="J12"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="K03"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L02"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L03"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L11"),]
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L21"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L23"),] #No births after 1980
SRKW_FecuTrimmed<-SRKW_FecuTrimmed[!(SRKW_FecuTrimmed$ID=="L45"),] #No births after 1980
## Add region so we can tell them apart
NRKW_FecuTrimmed$Region <- "North"
SRKW_FecuTrimmed$Region <- "South"
NRBirthrate <- merge(aggregate(NRKW_FecuTrimmed$Calved, by=list(Category=NRKW_FecuTrimmed$Year), FUN=sum), aggregate(NRKW_FecuTrimmed$ID, by=list(Category=NRKW_FecuTrimmed$Year), FUN=length), by="Category")
head(NRBirthrate)
colnames(NRBirthrate) <- c("Year", "SumCalved","N")
head(NRBirthrate)
NRBirthrate$Birthrate <- NRBirthrate$SumCalved/NRBirthrate$N
NRBirthrate$BRDiff <- NRBirthrate$Birthrate/mean(NRBirthrate$Birthrate)
NRKW_FecuTrimmed <- merge(NRKW_FecuTrimmed, NRBirthrate, by="Year")
SRBirthrate <- merge(aggregate(SRKW_FecuTrimmed$Calved, by=list(Category=SRKW_FecuTrimmed$Year), FUN=sum), aggregate(SRKW_FecuTrimmed$ID, by=list(Category=SRKW_FecuTrimmed$Year), FUN=length), by="Category")
head(SRBirthrate)
colnames(SRBirthrate) <- c("Year", "SumCalved","N")
head(SRBirthrate)
SRBirthrate$Birthrate <- SRBirthrate$SumCalved/SRBirthrate$N
SRBirthrate$BRDiff <- SRBirthrate$Birthrate/mean(SRBirthrate$Birthrate)
SRKW_FecuTrimmed <- merge(SRKW_FecuTrimmed, SRBirthrate, by="Year")
head(NRKW_FecuTrimmed)
head(SRKW_FecuTrimmed)
head(NRBirthrate)
## and bind!
FecuTrimmed_allyears2 <- rbind(SRKW_FecuTrimmed, NRKW_FecuTrimmed)
head(Salmon_since_1980)
##adding salmon data to fecundity2
dfsALL2 <- list(FecuTrimmed_allyears2, Salmon_since_1980)
FecuTrimmed_allyears <- join_all(dfsALL2, type="full", match = "all")
#FecuTrimmed_allyears <- merge(FecuTrimmed_allyears2, Salmon_since_1980, by="Year", no.dups = FALSE)
head(FecuTrimmed_allyears)
plot(FecuTrimmed_allyears$Calved~FecuTrimmed_allyears$Age)
is.numeric(FecuTrimmed_allyears$Age)
plot(FecuTrimmed_allyears$BRDiff~FecuTrimmed_allyears$WCVI_Index)
plot(FecuTrimmed_allyears$BRDiff~FecuTrimmed_allyears$WCVI_Index.lag1)
plot(Salmon_since_1980$WCVI_Index~Salmon_since_1980$Year)
plot(Salmon_since_1980$WCVI_Index~Salmon_since_1980$Year)
plot(FecuTrimmed_allyears$WCVI_Index~FecuTrimmed_allyears$Year)
str(Salmon_since_1980)
plot(FecuTrimmed_allyears$Calved~FecuTrimmed_allyears$WCVI_Index)
plot(FecuTrimmed_allyears$Calved~FecuTrimmed_allyears$WCVI_Index)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + Region,
family=binomial(link="logit"),
data=FecuTrimmed_allyears)
str(FecuTrimmed_allyears)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial(link="logit"),
data=FecuTrimmed_allyears)
summary(ALL_WCVI_Index_fit)
glmData <- FecuTrimmed_allyears %>%
select(Calved, Age, WCVI_Index, Region)
str(FecuTrimmed_allyears)
glmData <- FecuTrimmed_allyears %>%
dplyr::select(Calved, Age, WCVI_Index, Region)
head(glmData)
str(glmData)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial(link="logit"),
data=glmData)
summary(ALL_WCVI_Index_fit)
hist(resid(ALL_WCVI_Index_fit))
str(ALL_WCVI_Index_fit)
ALL_WCVI_Index_fit$coefficients
.99e-2
9.9e-2
str(FecuTrimmed_allyears)
unique(FecuTrimmed_allyears$Year)
glmData <- FecuTrimmed_allyears %>%
filter(Year < 2008) %>%
dplyr::select(Calved, Age, WCVI_Index, Region)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial(link="logit"),
data=glmData)
summary(ALL_WCVI_Index_fit)
glmData <- FecuTrimmed_allyears %>%
filter(Year < 2008)
tail(glmData)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial,
data=glmData)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial(link="logit"),
data=glmData)
ALL_WCVI_Index_fit2 <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial,
data=glmData)
ALL_WCVI_Index_fit$coefficients
ALL_WCVI_Index_fit2$coefficients
summary(ALL_WCVI_Index_fit)
modCoefs <- ALL_WCVI_Index_fit$coefficients
## exponentiate coefficients to transform logits into odds-ratios
exp(modCoefs)
glmData <- FecuTrimmed_allyears %>%
filter(Year < 2007) %>%
dplyr::select(Calved, Age, WCVI_Index, Region)
ALL_WCVI_Index_fit <- glm(Calved ~ poly(Age, 4) + WCVI_Index + as.factor(Region),
family=binomial(link="logit"),
data=glmData)
summary(ALL_WCVI_Index_fit)
## Simpler model
ageMod <- glm(Calved ~ poly(Age, 4), family=binomial(link="logit"),
data=glmData)
plot(Calved ~ Age, data= glmData)
lines(fitted(ageMod) ~ x, data = glmData, col = "red")
lines(fitted(ageMod) ~ Age, data = glmData, col = "red")
lines(fitted(ALL_WCVI_Index_fit) ~ Age, data = glmData, col = "red")
ageSeq <- seq(min(glmData$Age), max(glmData$Age), length = 1000)
ageSeq
ageSeq <- seq(min(glmData$Age - 1), max(glmData$Age + 1), length = 1000)
plot(Calved ~ Age, data = glmData, xlim = c(min(ageSeq), max(ageSeq)))
agePred <- predict(ageMod, list(Age = ageSeq), type = "response", se = T)
lines(agePred$fit ~ ageSeq)
lines(agePred$fit+agePred$se.fit ~ ageSeq)
plot(Calved ~ Age, data = glmData, xlim = c(min(ageSeq), max(ageSeq)))
lines(agePred$fit ~ ageSeq, lty = 1)
lines(agePred$fit+agePred$se.fit ~ ageSeq, lty = 2)
lines(agePred$fit-agePred$se.fit ~ ageSeq, lty = 2)
## Simpler model predictions
ageMod <- glm(Calved ~ poly(Age, 4), family=binomial,
data=glmData)
ageSeq <- seq(min(glmData$Age - 1), max(glmData$Age + 1), length = 1000)
agePred <- predict(ageMod, list(Age = ageSeq), type = "response", se = T)
plot(Calved ~ Age, data = glmData, xlim = c(min(ageSeq), max(ageSeq)))
lines(agePred$fit ~ ageSeq, lty = 1)
lines(agePred$fit + agePred$se.fit ~ ageSeq, lty = 2)
lines(agePred$fit - agePred$se.fit ~ ageSeq, lty = 2)
