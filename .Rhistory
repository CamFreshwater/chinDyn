filter(j_group2 == "sog") %>%
# ocean entry year herring abundance
left_join(.,
herr_year0 %>%
select(year = ck_ocean_year0, herr_abund_OEY = herr_age0_abund),
by = "year") %>%
# ocean entry year + 1 herring abundance
left_join(.,
herr_year1 %>%
rename(year = ck_ocean_year1),
by = "year") %>%
glimpse()
herr_reg = case_when(
stock %in% c("WCVIHerringR", "SoGHerringR") ~ "south",
stock %in% c("HGHerringR", "CCHerringR", "PRDHerringR") ~ "north"
),
ck_ocean_year1 = herring_age0_year - 1) %>%
group_by(ck_ocean_year1, herr_reg) %>%
summarize(agg_abund = sum(herr_abund), .groups = "drop") %>%
pivot_wider(names_from = herr_reg, values_from = agg_abund,
names_prefix = "herr_abund_OEY1_")
herr_reg = case_when(
stock %in% c("WCVIHerringR", "SoGHerringR") ~ "south",
stock %in% c("HGHerringR", "CCHerringR", "PRDHerringR") ~ "north"
),
ck_ocean_year1 = herring_age0_year - 1) %>%
group_by(ck_ocean_year1, herr_reg) %>%
summarize(agg_abund = sum(herr_abund), .groups = "drop") %>%
pivot_wider(names_from = herr_reg, values_from = agg_abund,
names_prefix = "herr_abund_OEY1_")
herr_year1 <- adult_cov$herring %>%
mutate(
herr_reg = case_when(
stock %in% c("WCVIHerringR", "SoGHerringR") ~ "south",
stock %in% c("HGHerringR", "CCHerringR", "PRDHerringR") ~ "north"
),
ck_ocean_year1 = herring_age0_year - 1) %>%
group_by(ck_ocean_year1, herr_reg) %>%
summarize(agg_abund = sum(herr_abund), .groups = "drop") %>%
pivot_wider(names_from = herr_reg, values_from = agg_abund,
names_prefix = "herr_abund_OEY1_")
# join relevant stock data, herring data and rkw
dat <- gen %>%
filter(j_group2 == "sog") %>%
# ocean entry year herring abundance
left_join(.,
herr_year0 %>%
select(year = ck_ocean_year0, herr_abund_OEY = herr_age0_abund),
by = "year") %>%
# ocean entry year + 1 herring abundance
left_join(.,
herr_year1 %>%
rename(year = ck_ocean_year1),
by = "year") %>%
glimpse()
# define oey1 herring abundance based on adult distribution
mutate(
herr_abund_OEY1 = case_when(
a_group2 == "south" ~ herr_abund_OEY1_south,
a_group2 == "offshore" ~ herr_abund_OEY1_north,
a_group2 == "north" ~ herr_abund_OEY1_north
)
) %>%
# rkw abundance
left_join(.,
rkw %>%
select(stock, brood_year, rollmean_rkw),
by = c("brood_year", "stock"))
# join relevant stock data, herring data and rkw
dat <- gen %>%
filter(j_group2 == "sog") %>%
# ocean entry year herring abundance
left_join(.,
herr_year0 %>%
select(year = ck_ocean_year0, herr_abund_OEY = herr_age0_abund),
by = "year") %>%
# ocean entry year + 1 herring abundance
left_join(.,
herr_year1 %>%
rename(year = ck_ocean_year1),
by = "year") %>%
# define oey1 herring abundance based on adult distribution
mutate(
herr_abund_OEY1 = case_when(
a_group2 == "south" ~ herr_abund_OEY1_south,
a_group2 == "offshore" ~ herr_abund_OEY1_north,
a_group2 == "north" ~ herr_abund_OEY1_north
)
) %>%
# rkw abundance
left_join(.,
rkw %>%
select(stock, brood_year, rollmean_rkw),
by = c("brood_year", "stock")) %>%
glimpse()
# join relevant stock data, herring data and rkw
dat <- gen %>%
filter(j_group2 == "sog") %>%
# ocean entry year herring abundance
left_join(.,
herr_year0 %>%
select(year = ck_ocean_year0, herr_abund_OEY = herr_age0_abund),
by = "year") %>%
# ocean entry year + 1 herring abundance
left_join(.,
herr_year1 %>%
rename(year = ck_ocean_year1),
by = "year") %>%
# define oey1 herring abundance based on adult distribution
mutate(
herr_abund_OEY1 = case_when(
a_group2 == "south" ~ herr_abund_OEY1_south,
a_group2 == "offshore" ~ herr_abund_OEY1_north,
a_group2 == "north" ~ herr_abund_OEY1_north
)
) %>%
# rkw abundance
left_join(.,
rkw %>%
select(stock, brood_year, rollmean_rkw),
by = c("brood_year", "stock")) %>%
# scale covariates
mutate(
herr_OEY_z = as.numeric(scale(herr_abund_OEY)),
herr_OEY1_z = as.numeric(scale(herr_abund_OEY1)),
rkw_z = as.numeric(scale(rollmean_rkw))
) %>%
select(stock, stock_name, brood_year, a_group2, gen_length, gen_z,
herr_abund_OEY, herr_abund_OEY1, rollmean_rkw, herr_OEY_z, herr_OEY1_z,
rkw_z)
glimpse(dat)
raw_gen
#distribution of generation length
gen %>%
# filter(!is.na(gen_length)) %>%
group_by(stock) %>%
ggplot(.) +
geom_histogram(aes(x = gen_z, fill = a_group)) +
facet_wrap(~ fct_reorder(stock, as.numeric(a_group))) +
theme(legend.position = "top") +
ggsidekick::theme_sleek()
#plot raw generation length data
raw_gen <- gen %>%
ggplot(.) +
geom_point(aes(x = year, y = log(gen_length), fill = a_group2), shape = 21) +
facet_wrap(~ fct_reorder(stock, as.numeric(a_group2))) +
theme(legend.position = "top") +
labs(y = "Mean Generation Length") +
ggsidekick::theme_sleek()
#distribution of generation length
gen %>%
group_by(stock) %>%
ggplot(.) +
geom_histogram(aes(x = log(gen_length), fill = a_group)) +
facet_wrap(~ fct_reorder(stock, as.numeric(a_group))) +
theme(legend.position = "top") +
ggsidekick::theme_sleek()
h_mod1 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
hist(resid(h_mod1))
# generate predictions for interaction model
excl_pars <- map(h_mod1$smooth, function(x) x$label) %>% unlist
excl_pars
seq(min(dat$her_OEY_z), max(dat$her_OEY_z), length.out = 75)
seq(min(dat$her_OEY_z, na.rm = TRUE),
max(dat$her_OEY_z, na.rm = TRUE),
length.out = 75)
glimpse(dat)
# join relevant stock data, herring data and rkw
dat <- gen %>%
filter(j_group2 == "sog") %>%
# ocean entry year herring abundance
left_join(.,
herr_year0 %>%
select(year = ck_ocean_year0, herr_abund_OEY = herr_age0_abund),
by = "year") %>%
# ocean entry year + 1 herring abundance
left_join(.,
herr_year1 %>%
rename(year = ck_ocean_year1),
by = "year") %>%
# define oey1 herring abundance based on adult distribution
mutate(
herr_abund_OEY1 = case_when(
a_group2 == "south" ~ herr_abund_OEY1_south,
a_group2 == "offshore" ~ herr_abund_OEY1_north,
a_group2 == "north" ~ herr_abund_OEY1_north
)
) %>%
# rkw abundance
left_join(.,
rkw %>%
select(stock, brood_year, rollmean_rkw),
by = c("brood_year", "stock")) %>%
# scale covariates
mutate(
herr_OEY_z = as.numeric(scale(herr_abund_OEY)),
herr_OEY1_z = as.numeric(scale(herr_abund_OEY1)),
rkw_z = as.numeric(scale(rollmean_rkw))
) %>%
select(stock, stock_name, brood_year, a_group2, gen_length, gen_z,
herr_abund_OEY, herr_abund_OEY1, rollmean_rkw, herr_OEY_z, herr_OEY1_z,
rkw_z) %>%
# remove missing data
filter(!is.na(rkw_z))
glimpse(dat)
seal_seq <- seq(min(dat$herr_OEY_z), max(dat$herr_OEY_z), length.out = 75)
seal_seq
new_dat <- expand.grid(#seal_anom = seal_seq,
herr_anom = herr_seq)
herr_seq <- seq(min(dat$herr_OEY_z), max(dat$herr_OEY_z), length.out = 75)
new_dat <- expand.grid(#seal_anom = seal_seq,
herr_anom = herr_seq)
excl_pars[grepl("stock", excl_pars)]
# fixed effects predictions
preds <- predict(h_mod1, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat <- expand.grid(#seal_anom = seal_seq,
herr_OEY_z = herr_seq)
# fixed effects predictions
preds <- predict(h_mod1, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_surv = plogis(link_fit),
pred_surv_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_surv_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_anom)) +
geom_line(aes(y = pred_surv)) +
geom_ribbon(aes(ymin = pred_surv_lo, ymax = pred_surv_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Survival")
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_surv)) +
geom_ribbon(aes(ymin = pred_surv_lo, ymax = pred_surv_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Survival")
glimpse(new_dat2)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_gen)) +
geom_ribbon(aes(ymin = pred_gen_lo, ymax = pred_gen_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
# lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Survival")
glimpse(dat)
h_mod1 <- gam(gen_length ~ s(herr_OEY_z, by = a_group2,
m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
map(h_mod1$smooth, function(x) x$label) %>% unlist
h_mod2 <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod3 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = a_group2, m = 1, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
# generate predictions for interaction model
excl_pars <- map(h_mod1$smooth, function(x) x$label) %>% unlist
herr_seq <- seq(min(dat$herr_OEY_z), max(dat$herr_OEY_z), length.out = 75)
new_dat <- expand.grid(#seal_anom = seal_seq,
herr_OEY_z = herr_seq,
a_group2 = unique(dat$a_group2))
head(new_dat)
# fixed effects predictions
preds <- predict(h_mod1, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# fixed effects predictions
preds <- predict(h_mod2, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_gen)) +
geom_ribbon(aes(ymin = pred_gen_lo, ymax = pred_gen_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
# lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Generation Length") +
facet_wrap(~a_group2)
# fixed effects predictions
preds <- predict(h_mod3, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_gen)) +
geom_ribbon(aes(ymin = pred_gen_lo, ymax = pred_gen_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
# lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Generation Length") +
facet_wrap(~a_group2)
h_mod1 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod2 <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod3 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = a_group2, m = 1, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
hist(resid(h_mod1))
AIC(h_mod1, h_mod2, h_mod3)
h_mod1 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod2 <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod3 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = a_group2, m = 1, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
AIC(h_mod1, h_mod2, h_mod3)
h_mod1 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod2 <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
h_mod3 <- gam(gen_length ~ s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = a_group2, m = 1, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(stock, bs = "re"),
data = dat)
AIC(h_mod1, h_mod2, h_mod3)
summary(h_mod1)
summary(h_mod3)
AIC(h_mod1, h_mod2, h_mod3)
h_mod2 <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(a_group2, bs = "tp") +
s(stock, bs = "re"),
data = dat)
h_mod2a <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(a_group2) +
s(stock, bs = "re"),
data = dat)
h_mod2b <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(a_group2, bs = "re") +
s(stock, bs = "re"),
data = dat)
h_mod2a <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
a_group2 +
s(stock, bs = "re"),
data = dat)
h_mod2b <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = stock, m = 1, bs = "tp", k = 4) +
s(a_group2, bs = "re") +
s(stock, bs = "re"),
data = dat)
AIC(h_mod1, h_mod2a, h_mod2b, h_mod3)
summary(h_mod2a)
summary(h_mod2b)
h_mod2a <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
a_group2 +
s(stock, bs = "re"),
data = dat)
h_mod2b <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(a_group2, bs = "re") +
s(stock, bs = "re"),
data = dat)
h_mod2a <- gam(gen_length ~  s(herr_OEY_z, m = 2, bs = "tp", k = 4) +
s(herr_OEY_z, by = a_group2, m = 1, bs = "tp", k = 4) +
a_group2 +
s(stock, bs = "re"),
data = dat)
h_mod2b <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
a_group2 +
s(stock, bs = "re"),
data = dat)
h_mod2c <- gam(gen_length ~ s(herr_OEY_z, by = a_group2, m = 2, bs = "tp", k = 4) +
s(a_group2, bs = "re") +
s(stock, bs = "re"),
data = dat)
AIC(h_mod2a, h_mod2b, h_mod2c)
# fixed effects predictions
preds <- predict(h_mod2a, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_gen)) +
geom_ribbon(aes(ymin = pred_gen_lo, ymax = pred_gen_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
# lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Generation Length") +
facet_wrap(~a_group2)
# fixed effects predictions
preds <- predict(h_mod2b, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_gen)) +
geom_ribbon(aes(ymin = pred_gen_lo, ymax = pred_gen_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
# lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Generation Length") +
facet_wrap(~a_group2)
# fixed effects predictions
preds <- predict(h_mod2c, new_dat, se.fit = TRUE,
exclude = excl_pars[grepl("stock", excl_pars)],
newdata.guaranteed = TRUE)
new_dat2 <- new_dat %>%
mutate(link_fit = as.numeric(preds$fit),
link_se = as.numeric(preds$se.fit),
pred_gen = plogis(link_fit),
pred_gen_lo = plogis(link_fit + (qnorm(0.025) * link_se)),
pred_gen_up = plogis(link_fit + (qnorm(0.975) * link_se))
)
# herring only fixed effects
# zero_seal <- new_dat2$seal_anom[which.min(abs(new_dat2$seal_anom - 0))]
new_dat2 %>%
# filter(seal_anom == zero_seal) %>%
ggplot(., aes(x = herr_OEY_z)) +
geom_line(aes(y = pred_gen)) +
geom_ribbon(aes(ymin = pred_gen_lo, ymax = pred_gen_up), alpha = 0.3) +
ggsidekick::theme_sleek() +
# lims(y = c(0.01, 0.05)) +
labs(x = "Herring Anomaly", y = "Predicted Generation Length") +
facet_wrap(~a_group2)
60*360
