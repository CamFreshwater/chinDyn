---
title: "Chinook Dynamic Factor Analysis"
author: "Cam Freshwater"
date: "April 24, 2019"
output: html_document
---

Dynamic factor analysis is approximately equivalent to a PCA (i.e. identifies patterns of shared variability), but specifically tailored towards time series. Here we are using smolt-adult return rates to evaluate evidence for coherent trends in productivity among Chinook salmon stocks throughout the north Pacific.

```{r loadData}
require(here); require(MARSS); require(tidyverse); require(ggplot2)

byDat <- read.csv(here("data/salmonData/CLEANcwtInd_age2SR_BY.csv"), 
                  stringsAsFactors = FALSE)
eyDat <- read.csv(here("data/salmonData/CLEANcwtInd_age2SR_OEY.csv"), 
                  stringsAsFactors = FALSE)

byDat <- 

# Convert to matrices (necessary for DFA)
byMat <- byDat %>%
  select(BY, stock, surv) %>% 
  spread(key = stock, value = surv) %>% 
  select(-BY) %>% 
  as.matrix() %>% 
  t()
broodYrs <- unique(byDat$BY)
colnames(byMat) <- broodYrs



```